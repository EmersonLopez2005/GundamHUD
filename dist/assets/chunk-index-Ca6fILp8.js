const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-LoadCharts-BAhayun9.js","assets/entry-index-DK0wTc_i.js","assets/chunk-react-vendor-c5ypKtDW.js","assets/index-D1W9V5WM.css","assets/chunk-chartHelper-BdgZw1x1.js","assets/chunk-card-Bf39RBRU.js","assets/chunk-progress-circle-DvZ4GioP.js","assets/chunk-PingChart-a4vL73C_.js","assets/chunk-tips-CZ7npuTU.js"])))=>i.map(i=>d[i]);
import{c as B,r as i,k as P,j as e,f as r,e as U,d as V,p as W,q,i as A,u as G,s as J,m as _,B as f,_ as k}from"./entry-index-DK0wTc_i.js";import{C as K,a as Q,b as X,c as Y}from"./chunk-card-Bf39RBRU.js";import{u as Z,C as ee,F as se}from"./chunk-progress-circle-DvZ4GioP.js";import"./chunk-react-vendor-c5ypKtDW.js";/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ae=B("arrow-left",te),ie=i.memo(({node:a})=>{const{liveData:p}=P(),m=i.useMemo(()=>({...a,stats:p?.[a.uuid]}),[a,p]),{stats:s,isOnline:l,trafficPercentage:n}=Z(m);return e.jsxs(K,{children:[e.jsx(Q,{className:"pb-2",children:e.jsx(X,{children:"详细信息"})}),e.jsxs(Y,{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"theme-text-muted",children:"CPU"}),e.jsx("p",{children:`${a.cpu_name} (x${a.cpu_cores})`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"架构"}),e.jsx("p",{children:a.arch})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"虚拟化"}),e.jsx("p",{children:a.virtualization})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"GPU"}),e.jsx("p",{children:a.gpu_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"操作系统"}),e.jsx("p",{children:a.os})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"内存"}),e.jsx("p",{children:s&&l?`${r(s.ram)} / ${r(a.mem_total)}`:`N/A / ${r(a.mem_total)}`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"交换内存"}),e.jsx("p",{children:a.swap_total===0?"OFF":s&&l?`${r(s.swap)} / ${r(a.swap_total)}`:`N/A / ${r(a.swap_total)}`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"磁盘"}),e.jsx("p",{children:s&&l?`${r(s.disk)} / ${r(a.disk_total)}`:`N/A / ${r(a.disk_total)}`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"运行时间"}),e.jsx("p",{children:U(s?.uptime||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"实时网络"}),e.jsx("p",{children:s&&l?`↑ ${r(s.net_out,!0)} ↓ ${r(s.net_in,!0)}`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"总流量"}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.traffic_limit!==0&&l&&s&&e.jsx(ee,{value:n,maxValue:100,size:32,strokeWidth:4,showPercentage:!0}),e.jsxs("div",{children:[e.jsx("p",{children:s&&l?`↑ ${r(s.net_total_up)} ↓ ${r(s.net_total_down)}`:"N/A"}),e.jsx("p",{children:V(a.traffic_limit,a.traffic_limit_type)})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"负载"}),e.jsx("p",{children:s&&l?`${s.load.toFixed(2)} | ${s.load5.toFixed(2)} | ${s.load15.toFixed(2)}`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"theme-text-muted",children:"最后上报"}),e.jsx("p",{children:s&&l?new Date(s.time).toLocaleString():"N/A"})]})]})]})}),re=i.lazy(()=>k(()=>import("./chunk-LoadCharts-BAhayun9.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),le=i.lazy(()=>k(()=>import("./chunk-PingChart-a4vL73C_.js"),__vite__mapDeps([7,1,2,3,5,4,8,6]))),me=()=>{const{uuid:a}=W(),p=q(),{nodes:m,loading:s}=A(),{liveData:l}=P();A();const[n,S]=i.useState(null),[L,N]=i.useState(!1),[d,z]=i.useState("load"),[j,D]=i.useState("load"),[u,g]=i.useState("fading-in"),[y,E]=i.useState(0),[b,R]=i.useState(1),{enableInstanceDetail:I,enablePingChart:M,publicSettings:C}=G(),F=J(),h=C?.record_preserve_time||0,x=C?.ping_record_preserve_time||24,v=i.useMemo(()=>[{label:"实时",hours:0},{label:"1小时",hours:1},{label:"4小时",hours:4},{label:"1天",hours:24},{label:"7天",hours:168},{label:"30天",hours:720}],[]),H=i.useMemo(()=>{const t=v.filter(c=>c.hours!==0&&c.hours<=x);return x>720&&t.push({label:`${x}小时`,hours:x}),t},[v,x]),O=i.useMemo(()=>{const t=v.filter(c=>c.hours<=h);return h>720&&t.push({label:`${h}小时`,hours:h}),t},[v,h]);i.useEffect(()=>{if(Array.isArray(m)){const t=m.find(c=>c.uuid===a);S(t||null)}},[m,a]),i.useEffect(()=>{N(!1)},[a]);const $=i.useMemo(()=>{if(!(!n||!l))return l[n.uuid]},[n,l]),o=n,w=$?.online??!1;i.useEffect(()=>{if(s){N(!1);return}if(!o)return;const t=setTimeout(()=>N(!0),300);return()=>clearTimeout(t)},[o,s]),i.useEffect(()=>{if(d===j){if(u==="fading-in"){const c=setTimeout(()=>g("idle"),300);return()=>clearTimeout(c)}return}g("fading-out");const t=setTimeout(()=>{D(d),g("fading-in")},200);return()=>clearTimeout(t)},[d,j,u]);const T=t=>{t===d||u==="fading-out"||z(t)};return!o||!n?s?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(_,{text:"正在获取节点信息..."})}):e.jsx("div",{className:"flex items-center justify-center h-full",children:"未找到该节点"}):L?e.jsxs("div",{className:"text-card-foreground space-y-4 my-4 fade-in",children:[e.jsx("div",{className:"flex items-center justify-between purcarte-blur theme-card-style p-4 mb-4 text-secondary-foreground",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(f,{className:"flex-shrink-0",variant:"outline",size:"icon",onClick:()=>p(-1),children:e.jsx(ae,{})}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(se,{flag:o.region}),e.jsx("span",{className:"text-xl md:text-2xl font-bold",children:o.name})]}),e.jsx("span",{className:"text-sm text-secondary-foreground flex-shrink-0",children:w?"在线":"离线"})]})}),I&&o&&e.jsx(ie,{node:o}),e.jsxs("div",{className:"flex flex-col items-center w-full space-y-4",children:[e.jsx("div",{className:"purcarte-blur theme-card-style p-2",children:e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(f,{variant:d==="load"?"secondary":"ghost",size:"sm",onClick:()=>T("load"),children:"负载"}),M&&e.jsx(f,{variant:d==="ping"?"secondary":"ghost",size:"sm",onClick:()=>T("ping"),children:"延迟"})]})}),e.jsx("div",{className:`purcarte-blur theme-card-style justify-center p-2 ${F?"w-full":""}`,children:d==="load"?e.jsx("div",{className:"flex space-x-2 overflow-x-auto whitespace-nowrap",children:O.map(t=>e.jsx(f,{variant:y===t.hours?"secondary":"ghost",size:"sm",onClick:()=>E(t.hours),children:t.label},t.label))}):e.jsx("div",{className:"flex space-x-2 overflow-x-auto whitespace-nowrap",children:H.map(t=>e.jsx(f,{variant:b===t.hours?"secondary":"ghost",size:"sm",onClick:()=>R(t.hours),children:t.label},t.label))})})]}),e.jsx("div",{className:u==="fading-out"?"fade-out":u==="fading-in"?"fade-in":void 0,children:e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(_,{text:"正在加载图表..."})}),children:j==="load"&&n?e.jsx(re,{node:n,hours:y,liveData:$,isOnline:w}):j==="ping"&&n?e.jsx(le,{node:n,hours:b}):null})})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(_,{text:"正在进入节点详情...",className:s?"":"fade-out"})})};export{me as default};
